# Модуль сегментации

- Прочитать на другом язык [English](README.md)

## Описание структуры

Примечание: поскольку это мой первый проект подобного рода, то структура проекта, возможно, не очень удобная.
То же самое относится и к коду проекта. Я его использовал в таком виде, в котором он сейчас находится.
Его вполне можно использовать как основу для разработки своего собственного решения.

- `/configs` - папка, в которой хранятся json файлы с конфигурацией
- `config.py` - код класса Config для чтения json файла с конфигурацией тренировки
- `dataset.py` - код, используемый для предобработки изображений и генерации масок
    - Если нужно использовать другой набор данных для тренировки, то лучше реализовать другой класс Dataset в этом файле
- `losses.py` - содержит реализованные функции потерь для модуля сегментации
    - Поскольку модель возвращает словарь из масок, то для вычисления функции потерь важно соблюдать формат вывода
      модели
- `metrics.py` - содержит метрики, использованные для оценки качества
- `models.py` - содержит реализацию моделей используемых для сегментации - результатом модели является словарь из
  предсказанных масок
- `predictor.py` - содержит методы для извлечения контуров и алгоритмы обработки контуров, в методах есть
  закомментированные код, использованный для визуализации результатов
- `preprocessing.py` - содержит методы предобработки изображений для модели сегментации
- `utils.py` - содержит вспомогательные методы визуализации и расчета дополнительных показателей
- `train.ipynb` - содержит код использованный для обучения моделей

Описание формата файлы конфигурации на текущий момент:

```json
{
    "images": {
        "width": "int",
        "height": "int"
    },
    "masks": {
        "binary": "List[int]",
        "lines": "int",
        "border_mask": "List[int]",
        "watershed": "List[int]"
    }
}
```

В параметре "image" пишутся значения, к которым будут приводиться все входящие изображения

В параметре "masks" пишутся маски, которые будут использоваться в модели.
Очень важно соблюдать порядок, поскольку на протяжении всего пайплайна генерируется словарь со схожим форматом.
Название маски может быть любое. Главное помнить, как к ней обращаться.
Прежде, чем редактировать код, лучше изучить как осуществляется весь процесс обучения.

## Как я обучал модели?

- Поскольку локально я не имею GPU, то я использовал платформу kaggle.com
- На платформе kaggle.com я открывал ноутбук `train.ipynb` и запускал ячейки
  (текущий ноутбук содержит в себе некоторые результаты запуска ячеек)
- Я старался обобщать все параметры в ноутбуке, чтобы модель тоже можно было запускать на других платформах
- Советую быть аккуратным и все перепроверять, если используете
- Параметры для сохранения результатов прописаны в ноутбуке
  (при желании их можно вынести в конфигурационный файл)
